#!/bin/sh

# Set the default cursor.
xsetroot -cursor_name left_ptr

# Authentication Agents and Other Daemons.
reboot-services.sh

# Load agent environment variables.
. $HOME/lib/sh/agents/agent-env.sh

# mlterm is a terminal emulator daemon.  Once it's started you use
# mlclient to start new X terminal emulators that share resources.
mlterm --daemon=genuine --screens=0

# Screen-saver
if which xscreensaver 2>&1 > /dev/null; then
  xscreensaver -no-splash &
fi

# Mount my encrypted drives.
if [ -r ~/etc/keys.img ]; then
  mount-keys.sh &
fi

# On-screen notifications.
/usr/lib/notification-daemon/notification-daemon &

# Set my desktop background.
if [ -r $HOME/.fehbg ]; then
  sh $HOME/.fehbg &
fi

# Remap my keys, but do it in the background so it doesn't conflict
# with xorg setting up the keyboard.
(sleep 8; xmodmap -pke > ~/.xmodmap.orig; xmodmap ~/.xmodmaprc) &

# Finally, execute my window manager.
exec $HOME/bin/xmonad
